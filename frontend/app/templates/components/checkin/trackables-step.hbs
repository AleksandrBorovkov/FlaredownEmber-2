{{partial "components/checkin/step-header"}}

{{#each sortedTrackeds as |tracked|}}
  {{#unless tracked.isPreparedForDestroy}}
    <div class="trackable-row {{trackableType}}-row">
      {{draggable-dropzone itemId=tracked.id
                           onDropped=(action 'move') }}
      <div class="1-col-filler"></div>
      {{#draggable-item itemId=tracked.id}}
        {{#if trackableTypeIsTreatment}}
          {{checkin-treatment model=tracked
                              onIsTakenChanged=(action 'saveChanges')
                              onDoseChanged=(action 'saveChanges')
                              onRemove=(action 'remove') }}
        {{else}}
          {{tracked-level model=tracked
                          valueKey='value'
                          onValueChanged=(action 'saveChanges')
                          onRemove=(action 'remove') }}
        {{/if}}
      {{/draggable-item}}
      <div class="1-col-filler"></div>
    </div>
  {{/unless}}
{{/each}}

<br>
{{trackables-select trackableType=trackableType
                    selected=selectedTrackable
                    onSelect=(action "add") }}

{{#unless embeddedInSummary}}
  {{step-controls step=model.currentStep
                  forwardLabel="Next"
                  disabled=checkin.hasDirtyAttributes
                  onBackward=(action "goBack")
                  onForward=(action "completeStep") }}
{{/unless}}
